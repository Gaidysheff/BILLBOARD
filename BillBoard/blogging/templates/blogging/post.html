{% extends 'blogging/base.html' %} {% load blogging_tags %} {% block content %}

<!-- --------------------------------- -->
{% show_categories '-name' cat_selected %}
<!-- --------------------------------- -->

<div class="container">
  <div class="row">
    <div class="col" style="padding-top: 20px">
      <div class="card">
        <h5>Категория: {{post.postCategory}}</h5>
        <p>Дата: {{post.dateCreation|date:"d-m-Y H:i:s"}}</p>
        {% if post.photo %}
        <img class="card-img-top" src="{{post.photo.url}}" alt="image" />
        {% endif %}
        <div class="card-body">
          <h4 class="card-title">{{post.title}}</h4>
          <p class="card-text">{{post.text|linebreaks}}</p>
          {% if post.upload %}
          <video
            width="640"
            height="480"
            controls
            src="{{ post.upload.url }}"
            alt="video"
          >
            Your browser does not support the video tag.
          </video>
          {% endif %}
          <!-- ------------------------------- -->
          <p>
            <a href="#"> Share this post </a>
          </p>
          <!-- ------------------------------- -->
          <a
            href="{% url 'comment' post.id %}"
            target="_blank"
            class="btn btn-info"
            >Комментировать</a
          >
          <a href="#" target="_blank" class="btn btn-warning">Изменить</a>
          <a href="#" class="btn btn-danger">Удалить</a>
        </div>
      </div>
    </div>
  </div>
</div>
<!-- <h1>Комментарии:</h1>
{% get_feedback as feedback %} {% for f in feedback %}
<p>{{f.author}} | {{f.dateCreation}}</p>
<h4>{{f.text}}</h4>
{% endfor %}  -->

<!-- -------------------------------------------------------------- -->
<div class="col-md-8 card mb-4 mt-3">
  <div class="card-body">
    <!-- comments -->
    <h4>{{ feedbacks.count }} комментариев</h4>

    <h1>Комментарии к этому посту:</h1>

    {% for feedback in feedbacks %}
    <div class="comments" style="padding: 10px">
      <p class="font-weight-bold">
        {{ feedback.author }}
        <span class="text-muted font-weight-normal">
          {{ comment.dateCreation }}
        </span>
      </p>
      {{ comment.text | linebreaks }}
    </div>
    {% endfor %}
  </div>
</div>
<!-- ----------------- a user makes a new comment ------------ -->
<div class="col-md-8 card mb-4 mt-3">
  <div class="card-body">
    {% if new_feedback %}
    <div class="alert alert-success" role="alert">
      Your feedback is awaiting moderation
    </div>
    {% else %}
    <h3>Оставить комментарий</h3>
    <form method="post" style="margin-top: 1.3em">
      {{ feedback_form.as_p }} {% csrf_token %}
      <button type="submit" class="btn btn-primary btn-lg">Submit</button>
    </form>
    {% endif %}
  </div>
</div>

{% endblock content %}
